let students = [{"id":1,"firstName":"Andie","lastName":"Bexon","isFired":true,"facultyID":1,"courses":[{"courseID":1,"grade":65},{"courseID":2,"grade":66}]},
{"id":2,"firstName":"Fritz","lastName":"Epine","isFired":true,"facultyID":2,"courses":[{"courseID":1,"grade":24},{"courseID":2,"grade":37},{"courseID":3,"grade":30}]},
{"id":3,"firstName":"Amelie","lastName":"Bickerstasse","isFired":false,"facultyID":3,"courses":[{"courseID":1,"grade":84}]},
{"id":4,"firstName":"Darcy","lastName":"Tome","isFired":true,"facultyID":4,"courses":[{"courseID":1,"grade":60},{"courseID":2,"grade":92},{"courseID":3,"grade":70},{"courseID":4,"grade":47},{"courseID":5,"grade":75}]},
{"id":5,"firstName":"Luella","lastName":"Liver","isFired":false,"facultyID":5,"courses":[{"courseID":1,"grade":87},{"courseID":2,"grade":18},{"courseID":3,"grade":56},{"courseID":4,"grade":19}]},
{"id":6,"firstName":"Jordan","lastName":"Spurgeon","isFired":true,"facultyID":6,"courses":[{"courseID":1,"grade":29},{"courseID":2,"grade":4},{"courseID":3,"grade":30},{"courseID":4,"grade":21},{"courseID":5,"grade":94}]},
{"id":7,"firstName":"Germain","lastName":"Bellison","isFired":true,"facultyID":7,"courses":[{"courseID":1,"grade":37},{"courseID":2,"grade":89},{"courseID":3,"grade":83},{"courseID":4,"grade":38},{"courseID":5,"grade":29}]},
{"id":8,"firstName":"Florri","lastName":"Jurzyk","isFired":true,"facultyID":8,"courses":[{"courseID":1,"grade":66},{"courseID":2,"grade":93},{"courseID":3,"grade":28}]},
{"id":9,"firstName":"Stafford","lastName":"Gipps","isFired":true,"facultyID":9,"courses":[{"courseID":1,"grade":19},{"courseID":2,"grade":55}]},
{"id":10,"firstName":"Fernandina","lastName":"Stillmann","isFired":true,"facultyID":10,"courses":[{"courseID":1,"grade":90},{"courseID":2,"grade":30},{"courseID":3,"grade":99},{"courseID":4,"grade":46}]},
{"id":11,"firstName":"Karina","lastName":"Volette","isFired":false,"facultyID":11,"courses":[{"courseID":1,"grade":6},{"courseID":2,"grade":16},{"courseID":3,"grade":81},{"courseID":4,"grade":16},{"courseID":5,"grade":82}]},
{"id":12,"firstName":"Neila","lastName":"Plevey","isFired":true,"facultyID":12,"courses":[]},
{"id":13,"firstName":"Frannie","lastName":"Jerzycowski","isFired":false,"facultyID":13,"courses":[{"courseID":1,"grade":34}]},
{"id":14,"firstName":"Berty","lastName":"Randals","isFired":true,"facultyID":14,"courses":[{"courseID":1,"grade":75},{"courseID":2,"grade":31},{"courseID":3,"grade":20}]},
{"id":15,"firstName":"Wendi","lastName":"Hastwell","isFired":false,"facultyID":15,"courses":[{"courseID":1,"grade":75},{"courseID":2,"grade":22}]},
{"id":16,"firstName":"Hyacinthe","lastName":"Philpin","isFired":true,"facultyID":16,"courses":[{"courseID":1,"grade":40},{"courseID":2,"grade":97}]},
{"id":17,"firstName":"Barton","lastName":"Minter","isFired":true,"facultyID":17,"courses":[{"courseID":1,"grade":45}]},
{"id":18,"firstName":"Arlie","lastName":"Shadrach","isFired":true,"facultyID":18,"courses":[{"courseID":1,"grade":6},{"courseID":2,"grade":56},{"courseID":3,"grade":73},{"courseID":4,"grade":73}]},
{"id":19,"firstName":"Hakeem","lastName":"Yellop","isFired":true,"facultyID":19,"courses":[{"courseID":1,"grade":20},{"courseID":2,"grade":59},{"courseID":3,"grade":11},{"courseID":4,"grade":38},{"courseID":5,"grade":95}]},
{"id":20,"firstName":"Salomone","lastName":"Suermeier","isFired":false,"facultyID":20,"courses":[{"courseID":1,"grade":63},{"courseID":2,"grade":86},{"courseID":3,"grade":59}]},
{"id":21,"firstName":"Findley","lastName":"Killock","isFired":true,"facultyID":21,"courses":[{"courseID":1,"grade":24},{"courseID":2,"grade":9},{"courseID":3,"grade":5}]},
{"id":22,"firstName":"Rollins","lastName":"Mahaddy","isFired":false,"facultyID":22,"courses":[{"courseID":1,"grade":70},{"courseID":2,"grade":18}]},
{"id":23,"firstName":"Olag","lastName":"Claworth","isFired":true,"facultyID":23,"courses":[{"courseID":1,"grade":100},{"courseID":2,"grade":81},{"courseID":3,"grade":53},{"courseID":4,"grade":85},{"courseID":5,"grade":20}]},
{"id":24,"firstName":"Bond","lastName":"Collet","isFired":false,"facultyID":24,"courses":[{"courseID":1,"grade":97}]},
{"id":25,"firstName":"Sydelle","lastName":"Gini","isFired":true,"facultyID":25,"courses":[{"courseID":1,"grade":40},{"courseID":2,"grade":46}]},
{"id":26,"firstName":"Elmore","lastName":"Gribbell","isFired":false,"facultyID":26,"courses":[{"courseID":1,"grade":49},{"courseID":2,"grade":68},{"courseID":3,"grade":90},{"courseID":4,"grade":95},{"courseID":5,"grade":25}]},
{"id":27,"firstName":"Darryl","lastName":"Kausche","isFired":true,"facultyID":27,"courses":[{"courseID":1,"grade":95},{"courseID":2,"grade":53}]},
{"id":28,"firstName":"Mirelle","lastName":"Pitfield","isFired":false,"facultyID":28,"courses":[{"courseID":1,"grade":76},{"courseID":2,"grade":100},{"courseID":3,"grade":17}]},
{"id":29,"firstName":"Ambrose","lastName":"Iohananof","isFired":false,"facultyID":29,"courses":[{"courseID":1,"grade":51},{"courseID":2,"grade":40},{"courseID":3,"grade":11}]},
{"id":30,"firstName":"Sophie","lastName":"Gregoletti","isFired":false,"facultyID":30,"courses":[{"courseID":1,"grade":19},{"courseID":2,"grade":89},{"courseID":3,"grade":62},{"courseID":4,"grade":48}]},
{"id":31,"firstName":"Hart","lastName":"Camerello","isFired":false,"facultyID":31,"courses":[{"courseID":1,"grade":74},{"courseID":2,"grade":3},{"courseID":3,"grade":33}]},
{"id":32,"firstName":"Bernetta","lastName":"Syvret","isFired":true,"facultyID":32,"courses":[{"courseID":1,"grade":47},{"courseID":2,"grade":9},{"courseID":3,"grade":97}]},
{"id":33,"firstName":"Eimile","lastName":"McGown","isFired":true,"facultyID":33,"courses":[{"courseID":1,"grade":42},{"courseID":2,"grade":12},{"courseID":3,"grade":24},{"courseID":4,"grade":40}]},
{"id":34,"firstName":"Torin","lastName":"Perrinchief","isFired":false,"facultyID":34,"courses":[{"courseID":1,"grade":73},{"courseID":2,"grade":63},{"courseID":3,"grade":8},{"courseID":4,"grade":14},{"courseID":5,"grade":75}]},
{"id":35,"firstName":"Sarajane","lastName":"Gallichiccio","isFired":true,"facultyID":35,"courses":[]},
{"id":36,"firstName":"Katinka","lastName":"Lightewood","isFired":false,"facultyID":36,"courses":[]},
{"id":37,"firstName":"Nisse","lastName":"McDougle","isFired":false,"facultyID":37,"courses":[{"courseID":1,"grade":63},{"courseID":2,"grade":8},{"courseID":3,"grade":92}]},
{"id":38,"firstName":"Carola","lastName":"Bold","isFired":true,"facultyID":38,"courses":[{"courseID":1,"grade":47},{"courseID":2,"grade":94},{"courseID":3,"grade":18},{"courseID":4,"grade":65}]},
{"id":39,"firstName":"Dalston","lastName":"Daid","isFired":true,"facultyID":39,"courses":[{"courseID":1,"grade":61},{"courseID":2,"grade":28},{"courseID":3,"grade":85},{"courseID":4,"grade":1},{"courseID":5,"grade":16}]},
{"id":40,"firstName":"Shannan","lastName":"Samsworth","isFired":false,"facultyID":40,"courses":[{"courseID":1,"grade":89}]},
{"id":41,"firstName":"Mirella","lastName":"Lindberg","isFired":false,"facultyID":41,"courses":[{"courseID":1,"grade":97},{"courseID":2,"grade":16},{"courseID":3,"grade":92},{"courseID":4,"grade":100},{"courseID":5,"grade":18}]},
{"id":42,"firstName":"Stanley","lastName":"Slyford","isFired":true,"facultyID":42,"courses":[]},
{"id":43,"firstName":"Ade","lastName":"Duerden","isFired":true,"facultyID":43,"courses":[{"courseID":1,"grade":90},{"courseID":2,"grade":29}]},
{"id":44,"firstName":"Winnifred","lastName":"Simoneau","isFired":true,"facultyID":44,"courses":[{"courseID":1,"grade":3},{"courseID":2,"grade":88},{"courseID":3,"grade":13},{"courseID":4,"grade":31}]},
{"id":45,"firstName":"Nathanil","lastName":"Malsher","isFired":false,"facultyID":45,"courses":[{"courseID":1,"grade":21},{"courseID":2,"grade":82}]},
{"id":46,"firstName":"Edgardo","lastName":"Guyet","isFired":false,"facultyID":46,"courses":[{"courseID":1,"grade":29},{"courseID":2,"grade":90}]},
{"id":47,"firstName":"Cesya","lastName":"Goodchild","isFired":false,"facultyID":47,"courses":[{"courseID":1,"grade":71}]},
{"id":48,"firstName":"Tomlin","lastName":"Winton","isFired":true,"facultyID":48,"courses":[{"courseID":1,"grade":51},{"courseID":2,"grade":80},{"courseID":3,"grade":58},{"courseID":4,"grade":79}]},
{"id":49,"firstName":"Hussein","lastName":"Lathwood","isFired":false,"facultyID":49,"courses":[{"courseID":1,"grade":32},{"courseID":2,"grade":100},{"courseID":3,"grade":88}]},
{"id":50,"firstName":"Spence","lastName":"Beven","isFired":true,"facultyID":50,"courses":[{"courseID":1,"grade":71},{"courseID":2,"grade":92}]}];

let faculties = [{"id":1,"facultyName":"University of Osteopathic Medicine and Health Science","address":"79582 Debs Road"},
{"id":2,"facultyName":"Jiangxi University of Finance and Economics","address":"9 Roxbury Place"},
{"id":3,"facultyName":"KASB Institute of Technology","address":"25 Brentwood Pass"},
{"id":4,"facultyName":"Mount St. Mary College","address":"367 Main Drive"},
{"id":5,"facultyName":"University of Alaska - Anchorage","address":"99157 Tony Road"},
{"id":6,"facultyName":"Azerbaijan Technical University","address":"0143 Prairieview Trail"},
{"id":7,"facultyName":"Volgograd State University","address":"1801 Transport Trail"},
{"id":8,"facultyName":"Escola Superior de Artes e Design","address":"7538 Mandrake Place"},
{"id":9,"facultyName":"Bharath Institue Of Higher Education & Research","address":"908 Lakewood Crossing"},
{"id":10,"facultyName":"Kamalolmolk Art & Architecture Higher Education Institute of Noshahr","address":"32 Stephen Junction"},
{"id":11,"facultyName":"Universidad Tecnologica \"Vicente Perez Rosales\"","address":"2996 Monica Avenue"},
{"id":12,"facultyName":"University of International Business and Economics","address":"53 Leroy Court"},
{"id":13,"facultyName":"Women's College of Fine Arts","address":"27001 Everett Road"},
{"id":14,"facultyName":"Renmin University of China","address":"7813 Ridgeway Road"},
{"id":15,"facultyName":"Alfaisal University","address":"63 Ridge Oak Drive"},
{"id":16,"facultyName":"Nishikyushu University","address":"371 Utah Street"},
{"id":17,"facultyName":"Universitas Klabat","address":"3 Debs Way"},
{"id":18,"facultyName":"Universidad de Los Andes","address":"1 Onsgard Street"},
{"id":19,"facultyName":"Moscow External University of the Humanities","address":"3773 Arizona Avenue"},
{"id":20,"facultyName":"University of Wamia and Masuria in Olsztyn","address":"1948 Hanover Parkway"},
{"id":21,"facultyName":"Universidade do Estado da Bahia","address":"6 Northwestern Parkway"},
{"id":22,"facultyName":"University of Bolton","address":"237 Weeping Birch Point"},
{"id":23,"facultyName":"Wenzhou Medical College","address":"32411 Miller Street"},
{"id":24,"facultyName":"Universidad de Iberoamérica","address":"111 Forest Dale Place"},
{"id":25,"facultyName":"International Academy of  Merchandising and Design Chicago","address":"862 Buell Park"},
{"id":26,"facultyName":"Illinois Benedictine University","address":"487 Northland Avenue"},
{"id":27,"facultyName":"Pennsylvania State University","address":"9 Arrowood Way"},
{"id":28,"facultyName":"Regent University College of Science and Technology  ","address":"9 Meadow Vale Street"},
{"id":29,"facultyName":"Universidad de Puerto Rico","address":"346 Linden Plaza"},
{"id":30,"facultyName":"Fujian Agricultural University","address":"32 Lakewood Park"},
{"id":31,"facultyName":"Fashion Institute of New York","address":"93 Bay Avenue"},
{"id":32,"facultyName":"Hunan Normal University","address":"2775 Straubel Drive"},
{"id":33,"facultyName":"Illinois School of Professional Psychology - Chicago Campus","address":"126 Becker Junction"},
{"id":34,"facultyName":"Universidade do Estado da Bahia","address":"4 Hermina Avenue"},
{"id":35,"facultyName":"St. Petersburg State Cinema and TV University","address":"0096 Longview Hill"},
{"id":36,"facultyName":"Universidad de las Américas","address":"35 Pond Crossing"},
{"id":37,"facultyName":"Ukrainian Medical Stomatological Academy","address":"006 Anhalt Lane"},
{"id":38,"facultyName":"Universidad de Ciego de Avila","address":"7825 Havey Terrace"},
{"id":39,"facultyName":"Gemsville Technical University","address":"294 Elgar Street"},
{"id":40,"facultyName":"Universidad CAECE, Buenos Aires","address":"31 Onsgard Drive"},
{"id":41,"facultyName":"Riga Technical University","address":"88 Bay Hill"},
{"id":42,"facultyName":"Hefei University of Technology","address":"18 Debra Terrace"},
{"id":43,"facultyName":"St. Louis College of Pharmacy","address":"8 Badeau Center"},
{"id":44,"facultyName":"Hotelschool The Hague","address":"5 Texas Point"},
{"id":45,"facultyName":"University of Applied Sciences of Moldova","address":"067 Pierstorff Place"},
{"id":46,"facultyName":"Pontificia Universidad Catolica de Puerto Rico","address":"0197 Vahlen Point"},
{"id":47,"facultyName":"Norwegian University of Sport and Physical Education","address":"87 Eagle Crest Plaza"},
{"id":48,"facultyName":"Universidade São Marcos","address":"70 Independence Road"},
{"id":49,"facultyName":"Dalian University","address":"22775 Hoard Pass"},
{"id":50,"facultyName":"Megatrend University of Applied Sciences","address":"603 Lake View Park"}];

let courses = [{"id":1,"courseName":"Telugu","finalMark":99},
{"id":2,"courseName":"Malay","finalMark":99},
{"id":3,"courseName":"Guaraní","finalMark":96},
{"id":4,"courseName":"Hebrew","finalMark":98},
{"id":5,"courseName":"Swedish","finalMark":98},
{"id":6,"courseName":"Gagauz","finalMark":98},
{"id":7,"courseName":"Punjabi","finalMark":100},
{"id":8,"courseName":"Quechua","finalMark":100},
{"id":9,"courseName":"Assamese","finalMark":98},
{"id":10,"courseName":"Moldovan","finalMark":99},
{"id":11,"courseName":"Norwegian","finalMark":100},
{"id":12,"courseName":"French","finalMark":100},
{"id":13,"courseName":"Tetum","finalMark":99},
{"id":14,"courseName":"Pashto","finalMark":96},
{"id":15,"courseName":"Haitian Creole","finalMark":95},
{"id":16,"courseName":"Romanian","finalMark":99},
{"id":17,"courseName":"Bengali","finalMark":95},
{"id":18,"courseName":"Malayalam","finalMark":100},
{"id":19,"courseName":"Latvian","finalMark":99},
{"id":20,"courseName":"West Frisian","finalMark":98},
{"id":21,"courseName":"Irish Gaelic","finalMark":96},
{"id":22,"courseName":"Kyrgyz","finalMark":97},
{"id":23,"courseName":"Northern Sotho","finalMark":100},
{"id":24,"courseName":"Dutch","finalMark":97},
{"id":25,"courseName":"Afrikaans","finalMark":96},
{"id":26,"courseName":"New Zealand Sign Language","finalMark":96},
{"id":27,"courseName":"Aymara","finalMark":99},
{"id":28,"courseName":"Kashmiri","finalMark":99},
{"id":29,"courseName":"Malayalam","finalMark":95},
{"id":30,"courseName":"Polish","finalMark":95},
{"id":31,"courseName":"Finnish","finalMark":98},
{"id":32,"courseName":"Tajik","finalMark":99},
{"id":33,"courseName":"Khmer","finalMark":96},
{"id":34,"courseName":"Papiamento","finalMark":97},
{"id":35,"courseName":"Montenegrin","finalMark":97},
{"id":36,"courseName":"Burmese","finalMark":95},
{"id":37,"courseName":"Dutch","finalMark":100},
{"id":38,"courseName":"Kurdish","finalMark":98},
{"id":39,"courseName":"Northern Sotho","finalMark":95},
{"id":40,"courseName":"Bulgarian","finalMark":98},
{"id":41,"courseName":"Haitian Creole","finalMark":97},
{"id":42,"courseName":"Icelandic","finalMark":96},
{"id":43,"courseName":"Montenegrin","finalMark":98},
{"id":44,"courseName":"Hebrew","finalMark":99},
{"id":45,"courseName":"Tsonga","finalMark":97},
{"id":46,"courseName":"Bislama","finalMark":99},
{"id":47,"courseName":"Oriya","finalMark":100},
{"id":48,"courseName":"Croatian","finalMark":95},
{"id":49,"courseName":"Estonian","finalMark":100},
{"id":50,"courseName":"Gujarati","finalMark":100}];

//Lab3
//1)
db.createCollection("students");
db.students.insertMany(students);
db.students.find()

db.createCollection("faculties");
db.faculties.insertMany(faculties);
db.faculties.find()

db.createCollection("courses");
db.courses.insertMany(courses);
db.courses.find()

//2. Display each student Full Name along with his average grade in all courses. $concat
db.students.aggregate([
    {
        $project: {
            _id:0,
            FullName: { $concat: ["$firstName", " ", "$lastName"] },
            AverageGrade: { $avg: "$courses.grade" } 
        }
    }
])

//3. Using aggregation display the sum of final mark for all courses in Course collection.
db.courses.aggregate([
    {
        $group: {
            _id: 0, 
            FinalMarksSummation: { $sum: "$finalMark" }
        }
    },
    {
        $project: {
            _id: 0 
        }
    }
])

//4. Implement (one to many) relation between Student and Course, by adding array of Courses IDs in the student object. 
//• Select specific student with his name, and then display his courses. 

let students2 = [{"id":1,"firstName":"Scott","lastName":"Ruller","isFired":false,"facultyID":1,"coursesIDs":[1,2]},
{"id":2,"firstName":"Morna","lastName":"Condell","isFired":true,"facultyID":2,"coursesIDs":[3]},
{"id":3,"firstName":"Miller","lastName":"Lunge","isFired":false,"facultyID":3,"coursesIDs":[4,5]},
{"id":4,"firstName":"Rennie","lastName":"McLurg","isFired":false,"facultyID":4,"coursesIDs":[6,7,8]},
{"id":5,"firstName":"Ondrea","lastName":"Chesney","isFired":false,"facultyID":5,"coursesIDs":[9]},
{"id":6,"firstName":"Archibold","lastName":"Vobes","isFired":true,"facultyID":6,"coursesIDs":[10,11,12]},
{"id":7,"firstName":"Wilona","lastName":"Domleo","isFired":false,"facultyID":7,"coursesIDs":[13,14,15]},
{"id":8,"firstName":"Yettie","lastName":"Weekland","isFired":true,"facultyID":8,"coursesIDs":[16,17]},
{"id":9,"firstName":"Zebulon","lastName":"Colman","isFired":true,"facultyID":9,"coursesIDs":[18,19,20]},
{"id":10,"firstName":"Nathalie","lastName":"Betchley","isFired":false,"facultyID":10,"coursesIDs":[21,22,23]},
{"id":11,"firstName":"Rawley","lastName":"Screeton","isFired":false,"facultyID":11,"coursesIDs":[24]},
{"id":12,"firstName":"Gannie","lastName":"Chicco","isFired":false,"facultyID":12,"coursesIDs":[25]},
{"id":13,"firstName":"Annalise","lastName":"Bundock","isFired":true,"facultyID":13,"coursesIDs":[26,27]},
{"id":14,"firstName":"Vachel","lastName":"Esche","isFired":true,"facultyID":14,"coursesIDs":[28,29,30]},
{"id":15,"firstName":"Geri","lastName":"Kilbey","isFired":true,"facultyID":15,"coursesIDs":[31,32]},
{"id":16,"firstName":"Marylou","lastName":"Burnyate","isFired":false,"facultyID":16,"coursesIDs":[33,34,35]},
{"id":17,"firstName":"Sonnnie","lastName":"Shirland","isFired":false,"facultyID":17,"coursesIDs":[36]},
{"id":18,"firstName":"Hilarius","lastName":"Whellans","isFired":false,"facultyID":18,"coursesIDs":[37]},
{"id":19,"firstName":"Emmaline","lastName":"Buttriss","isFired":false,"facultyID":19,"coursesIDs":[38,39]},
{"id":20,"firstName":"Zachary","lastName":"Le Barr","isFired":false,"facultyID":20,"coursesIDs":[40]}]

db.createCollection("students2");
db.students2.insertMany(students2);
db.students2.find()

var student = db.students2.findOne({ "firstName": "Emmaline" });
if(student){
   print(`${student.firstName} courses are:`);
   student.coursesIDs.forEach(courseID => {
        var course = db.courses.findOne({ "id": courseID });
        if (course) {
            print(`Course Name: ${course.courseName}`);
        }
   }); 
}

//4.Implement relation between Student and faculty by adding the faculty object in the student using _id Relation using $Lookup. 
//• Select specific student with his name, and then display his faculty

var student = db.students.findOne({ "firstName": "Andie" });
var studentFirstName = student.firstName;

   db.students.aggregate([
        {
            $match: {
                "firstName": studentFirstName
            }
        },
        {
            $lookup: {
                from: "faculties",
                localField: "facultyID",
                foreignField: "id",
                as: "faculty"
            }
        },
        {
            $project: {
                _id: 0, 
                name: studentFirstName, 
                faculty: "$faculty.facultyName"
            }
        }
    ]);